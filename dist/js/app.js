var gr=Object.create;var tt=Object.defineProperty;var yr=Object.getOwnPropertyDescriptor;var wr=Object.getOwnPropertyNames;var xr=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty;var A=(r,i)=>()=>(i||r((i={exports:{}}).exports,i),i.exports);var Ir=(r,i,s,a)=>{if(i&&typeof i=="object"||typeof i=="function")for(let f of wr(i))!br.call(r,f)&&f!==s&&tt(r,f,{get:()=>i[f],enumerable:!(a=yr(i,f))||a.enumerable});return r};var ee=(r,i,s)=>(s=r!=null?gr(xr(r)):{},Ir(i||!r||!r.__esModule?tt(s,"default",{value:r,enumerable:!0}):s,r));var J=A((oi,rt)=>{"use strict";function te(r,i,s,a,f,o){return{tag:r,key:i,attrs:s,children:a,text:f,dom:o,is:void 0,domSize:void 0,state:void 0,events:void 0,instance:void 0}}te.normalize=function(r){return Array.isArray(r)?te("[",void 0,void 0,te.normalizeChildren(r),void 0,void 0):r==null||typeof r=="boolean"?null:typeof r=="object"?r:te("#",void 0,void 0,String(r),void 0,void 0)};te.normalizeChildren=function(r){var i=[];if(r.length){for(var s=r[0]!=null&&r[0].key!=null,a=1;a<r.length;a++)if((r[a]!=null&&r[a].key!=null)!==s)throw new TypeError(s&&(r[a]==null||typeof r[a]=="boolean")?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");for(var a=0;a<r.length;a++)i[a]=te.normalize(r[a])}return i};rt.exports=te});var ve=A((li,it)=>{"use strict";var Tr=J();it.exports=function(r,i){return r==null||typeof r=="object"&&r.tag==null&&!Array.isArray(r)?i.length===1&&Array.isArray(i[0])&&(i=i[0]):(i=i.length===0&&Array.isArray(r)?r:[r,...i],r=void 0),Tr("",r&&r.key,r,i)}});var he=A((hi,nt)=>{"use strict";nt.exports={}.hasOwnProperty});var Me=A((pi,st)=>{"use strict";st.exports={}});var ze=A((mi,at)=>{"use strict";var Sr=Me();at.exports=new Map([[Sr,!0]])});var Fe=A((di,ct)=>{"use strict";var qr=J(),Cr=ve(),Ne=he(),ut=Me(),jr=ze(),Or=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,ft=Object.create(null);function Rr(r){for(var i in r)if(Ne.call(r,i))return!1;return!0}function Ar(r){return r==="value"||r==="checked"||r==="selectedIndex"||r==="selected"}function Er(r){for(var i,s="div",a=[],f={},o=!0;i=Or.exec(r);){var c=i[1],d=i[2];if(c===""&&d!=="")s=d;else if(c==="#")f.id=d;else if(c===".")a.push(d);else if(i[3][0]==="["){var p=i[6];p&&(p=p.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),i[4]==="class"?a.push(p):(f[i[4]]=p===""?p:p||!0,Ar(i[4])&&(o=!1))}}return a.length>0&&(f.className=a.join(" ")),Rr(f)?f=ut:jr.set(f,o),ft[r]={tag:s,attrs:f,is:f.is}}function vr(r,i){i.tag=r.tag;var s=i.attrs;if(s==null)return i.attrs=r.attrs,i.is=r.is,i;var a=Ne.call(s,"class"),f=a?s.class:s.className;return r.attrs!==ut?(s=Object.assign({},r.attrs,s),(f!=null||r.attrs.className!=null)&&(s.className=f!=null?r.attrs.className!=null?String(r.attrs.className)+" "+String(f):f:r.attrs.className)):f!=null&&(s.className=f),a&&(s.class=null),r.tag==="input"&&Ne.call(s,"type")&&(s=Object.assign({type:s.type},s)),i.is=s.is,i.attrs=s,i}function Mr(r,i,...s){if(r==null||typeof r!="string"&&typeof r!="function"&&typeof r.view!="function")throw Error("The selector must be either a string or a component.");var a=Cr(i,s);return typeof r=="string"&&(a.children=qr.normalizeChildren(a.children),r!=="[")?vr(ft[r]||Er(r),a):(a.attrs==null&&(a.attrs={}),a.tag=r,a)}ct.exports=Mr});var lt=A((gi,ot)=>{"use strict";var zr=J();ot.exports=function(r){return r==null&&(r=""),zr("<",void 0,void 0,r,void 0,void 0)}});var pt=A((yi,ht)=>{"use strict";var Nr=J(),Fr=ve();ht.exports=function(r,...i){var s=Fr(r,i);return s.attrs==null&&(s.attrs={}),s.tag="[",s.children=Nr.normalizeChildren(s.children),s}});var dt=A((wi,mt)=>{"use strict";var Pe=Fe();Pe.trust=lt();Pe.fragment=pt();mt.exports=Pe});var $e=A((xi,gt)=>{"use strict";var De=new WeakMap;function*Pr(r){var i=r.dom,s=r.domSize,a=De.get(i);if(i!=null)do{var f=i.nextSibling;De.get(i)===a&&(yield i,s--),i=f}while(s)}gt.exports={delayedRemoval:De,domFor:Pr}});var bt=A((bi,xt)=>{"use strict";var Le=J(),wt=$e(),Dr=wt.delayedRemoval,Ue=wt.domFor,yt=ze();xt.exports=function(){var r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},i,s;function a(t){return t.ownerDocument}function f(t){return t.attrs&&t.attrs.xmlns||r[t.tag]}function o(t,e){if(t.state!==e)throw new Error("'vnode.state' must not be modified.")}function c(t){var e=t.state;try{return this.apply(e,arguments)}finally{o(t,e)}}function d(t){try{return a(t).activeElement}catch{return null}}function p(t,e,n,u,l,m,S){for(var j=n;j<u;j++){var x=e[j];x!=null&&h(t,x,l,S,m)}}function h(t,e,n,u,l){var m=e.tag;if(typeof m=="string")switch(e.state={},e.attrs!=null&&Se(e.attrs,e,n),m){case"#":g(t,e,l);break;case"<":q(t,e,u,l);break;case"[":y(t,e,n,u,l);break;default:C(t,e,n,u,l)}else K(t,e,n,u,l)}function g(t,e,n){e.dom=a(t).createTextNode(e.children),k(t,e.dom,n)}var w={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function q(t,e,n,u){var l=e.children.match(/^\s*?<(\w+)/im)||[],m=a(t).createElement(w[l[1]]||"div");n==="http://www.w3.org/2000/svg"?(m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+e.children+"</svg>",m=m.firstChild):m.innerHTML=e.children,e.dom=m.firstChild,e.domSize=m.childNodes.length;for(var S=a(t).createDocumentFragment(),j;j=m.firstChild;)S.appendChild(j);k(t,S,u)}function y(t,e,n,u,l){var m=a(t).createDocumentFragment();if(e.children!=null){var S=e.children;p(m,S,0,S.length,n,null,u)}e.dom=m.firstChild,e.domSize=m.childNodes.length,k(t,m,l)}function C(t,e,n,u,l){var m=e.tag,S=e.attrs,j=e.is;u=f(e)||u;var x=u?j?a(t).createElementNS(u,m,{is:j}):a(t).createElementNS(u,m):j?a(t).createElement(m,{is:j}):a(t).createElement(m);if(e.dom=x,S!=null&&cr(e,S,u),k(t,x,l),!G(e)&&e.children!=null){var O=e.children;p(x,O,0,O.length,n,null,u),e.tag==="select"&&S!=null&&lr(e,S)}}function U(t,e){var n;if(typeof t.tag.view=="function"){if(t.state=Object.create(t.tag),n=t.state.view,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0}else{if(t.state=void 0,n=t.tag,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0,t.state=t.tag.prototype!=null&&typeof t.tag.prototype.view=="function"?new t.tag(t):t.tag(t)}if(Se(t.state,t,e),t.attrs!=null&&Se(t.attrs,t,e),t.instance=Le.normalize(c.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null}function K(t,e,n,u,l){U(e,n),e.instance!=null?(h(t,e.instance,n,u,l),e.dom=e.instance.dom,e.domSize=e.dom!=null?e.instance.domSize:0):e.domSize=0}function B(t,e,n,u,l,m){if(!(e===n||e==null&&n==null))if(e==null||e.length===0)p(t,n,0,n.length,u,l,m);else if(n==null||n.length===0)ue(t,e,0,e.length);else{var S=e[0]!=null&&e[0].key!=null,j=n[0]!=null&&n[0].key!=null,x=0,O=0;if(!S)for(;O<e.length&&e[O]==null;)O++;if(!j)for(;x<n.length&&n[x]==null;)x++;if(S!==j)ue(t,e,O,e.length),p(t,n,x,n.length,u,l,m);else if(j){for(var V=e.length-1,$=n.length-1,le,H,F,Q,v,je;V>=O&&$>=x&&(Q=e[V],v=n[$],Q.key===v.key);)Q!==v&&_(t,Q,v,u,l,m),v.dom!=null&&(l=v.dom),V--,$--;for(;V>=O&&$>=x&&(H=e[O],F=n[x],H.key===F.key);)O++,x++,H!==F&&_(t,H,F,u,Z(e,O,l),m);for(;V>=O&&$>=x&&!(x===$||H.key!==v.key||Q.key!==F.key);)je=Z(e,O,l),ae(t,Q,je),Q!==F&&_(t,Q,F,u,je,m),++x<=--$&&ae(t,H,l),H!==v&&_(t,H,v,u,l,m),v.dom!=null&&(l=v.dom),O++,V--,Q=e[V],v=n[$],H=e[O],F=n[x];for(;V>=O&&$>=x&&Q.key===v.key;)Q!==v&&_(t,Q,v,u,l,m),v.dom!=null&&(l=v.dom),V--,$--,Q=e[V],v=n[$];if(x>$)ue(t,e,O,V+1);else if(O>V)p(t,n,x,$+1,u,l,m);else{var dr=l,et=$-x+1,ce=new Array(et),Oe=0,N=0,Re=2147483647,Ae=0,le,Ee;for(N=0;N<et;N++)ce[N]=-1;for(N=$;N>=x;N--){le==null&&(le=E(e,O,V+1)),v=n[N];var ne=le[v.key];ne!=null&&(Re=ne<Re?ne:-1,ce[N-x]=ne,Q=e[ne],e[ne]=null,Q!==v&&_(t,Q,v,u,l,m),v.dom!=null&&(l=v.dom),Ae++)}if(l=dr,Ae!==V-O+1&&ue(t,e,O,V+1),Ae===0)p(t,n,x,$+1,u,l,m);else if(Re===-1)for(Ee=D(ce),Oe=Ee.length-1,N=$;N>=x;N--)F=n[N],ce[N-x]===-1?h(t,F,u,m,l):Ee[Oe]===N-x?Oe--:ae(t,F,l),F.dom!=null&&(l=n[N].dom);else for(N=$;N>=x;N--)F=n[N],ce[N-x]===-1&&h(t,F,u,m,l),F.dom!=null&&(l=n[N].dom)}}else{var Ce=e.length<n.length?e.length:n.length;for(x=x<O?x:O;x<Ce;x++)H=e[x],F=n[x],!(H===F||H==null&&F==null)&&(H==null?h(t,F,u,m,Z(e,x+1,l)):F==null?oe(t,H):_(t,H,F,u,Z(e,x+1,l),m));e.length>Ce&&ue(t,e,x,e.length),n.length>Ce&&p(t,n,x,n.length,u,l,m)}}}function _(t,e,n,u,l,m){var S=e.tag,j=n.tag;if(S===j&&e.is===n.is){if(n.state=e.state,n.events=e.events,mr(n,e))return;if(typeof S=="string")switch(n.attrs!=null&&qe(n.attrs,n,u),S){case"#":M(e,n);break;case"<":b(t,e,n,m,l);break;case"[":R(t,e,n,u,l,m);break;default:I(e,n,u,m)}else P(t,e,n,u,l,m)}else oe(t,e),h(t,n,u,m,l)}function M(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children),e.dom=t.dom}function b(t,e,n,u,l){e.children!==n.children?(We(t,e),q(t,n,u,l)):(n.dom=e.dom,n.domSize=e.domSize)}function R(t,e,n,u,l,m){B(t,e.children,n.children,u,l,m);var S=0,j=n.children;if(n.dom=null,j!=null){for(var x=0;x<j.length;x++){var O=j[x];O!=null&&O.dom!=null&&(n.dom==null&&(n.dom=O.dom),S+=O.domSize||1)}S!==1&&(n.domSize=S)}}function I(t,e,n,u){var l=e.dom=t.dom;u=f(e)||u,(t.attrs!=e.attrs||e.attrs!=null&&!yt.get(e.attrs))&&hr(e,t.attrs,e.attrs,u),G(e)||B(l,t.children,e.children,n,null,u)}function P(t,e,n,u,l,m){if(n.instance=Le.normalize(c.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");qe(n.state,n,u),n.attrs!=null&&qe(n.attrs,n,u),n.instance!=null?(e.instance==null?h(t,n.instance,u,m,l):_(t,e.instance,n.instance,u,l,m),n.dom=n.instance.dom,n.domSize=n.instance.domSize):e.instance!=null?(oe(t,e.instance),n.dom=void 0,n.domSize=0):(n.dom=e.dom,n.domSize=e.domSize)}function E(t,e,n){for(var u=Object.create(null);e<n;e++){var l=t[e];if(l!=null){var m=l.key;m!=null&&(u[m]=e)}}return u}var T=[];function D(t){for(var e=[0],n=0,u=0,l=0,m=T.length=t.length,l=0;l<m;l++)T[l]=t[l];for(var l=0;l<m;++l)if(t[l]!==-1){var S=e[e.length-1];if(t[S]<t[l]){T[l]=S,e.push(l);continue}for(n=0,u=e.length-1;n<u;){var j=(n>>>1)+(u>>>1)+(n&u&1);t[e[j]]<t[l]?n=j+1:u=j}t[l]<t[e[n]]&&(n>0&&(T[l]=e[n-1]),e[n]=l)}for(n=e.length,u=e[n-1];n-- >0;)e[n]=u,u=T[u];return T.length=0,e}function Z(t,e,n){for(;e<t.length;e++)if(t[e]!=null&&t[e].dom!=null)return t[e].dom;return n}function ae(t,e,n){if(e.dom!=null){var u;if(e.domSize==null)u=e.dom;else{u=a(t).createDocumentFragment();for(var l of Ue(e))u.appendChild(l)}k(t,u,n)}}function k(t,e,n){n!=null?t.insertBefore(e,n):t.appendChild(e)}function G(t){if(t.attrs==null||t.attrs.contenteditable==null&&t.attrs.contentEditable==null)return!1;var e=t.children;if(e!=null&&e.length===1&&e[0].tag==="<"){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(e!=null&&e.length!==0)throw new Error("Child node of a contenteditable must be trusted.");return!0}function ue(t,e,n,u){for(var l=n;l<u;l++){var m=e[l];m!=null&&oe(t,m)}}function ke(t,e,n,u){var l=e.state,m=c.call(n.onbeforeremove,e);if(m!=null){var S=s;for(var j of Ue(e))Dr.set(j,S);u.v++,Promise.resolve(m).finally(function(){o(e,l),Je(t,e,u)})}}function Je(t,e,n){--n.v===0&&(be(e),We(t,e))}function oe(t,e){var n={v:1};typeof e.tag!="string"&&typeof e.state.onbeforeremove=="function"&&ke(t,e,e.state,n),e.attrs&&typeof e.attrs.onbeforeremove=="function"&&ke(t,e,e.attrs,n),Je(t,e,n)}function We(t,e){if(e.dom!=null)if(e.domSize==null)t.removeChild(e.dom);else for(var n of Ue(e))t.removeChild(n)}function be(t){if(typeof t.tag!="string"&&typeof t.state.onremove=="function"&&c.call(t.state.onremove,t),t.attrs&&typeof t.attrs.onremove=="function"&&c.call(t.attrs.onremove,t),typeof t.tag!="string")t.instance!=null&&be(t.instance);else{t.events!=null&&(t.events._=null);var e=t.children;if(Array.isArray(e))for(var n=0;n<e.length;n++){var u=e[n];u!=null&&be(u)}}}function cr(t,e,n){for(var u in e)Ie(t,u,null,e[u],n)}function Ie(t,e,n,u,l){if(!(e==="key"||u==null||Ge(e)||n===u&&!pr(t,e)&&typeof u!="object")){if(e[0]==="o"&&e[1]==="n")return Ze(t,e,u);if(e.slice(0,6)==="xlink:")t.dom.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(6),u);else if(e==="style")Ye(t.dom,n,u);else if(Xe(t,e,l)){if(e==="value"){if((t.tag==="input"||t.tag==="textarea")&&t.dom.value===""+u||t.tag==="select"&&n!==null&&t.dom.value===""+u||t.tag==="option"&&n!==null&&t.dom.value===""+u)return;if(t.tag==="input"&&t.attrs.type==="file"&&""+u!=""){console.error("`value` is read-only on file inputs!");return}}t.tag==="input"&&e==="type"?t.dom.setAttribute(e,u):t.dom[e]=u}else typeof u=="boolean"?u?t.dom.setAttribute(e,""):t.dom.removeAttribute(e):t.dom.setAttribute(e==="className"?"class":e,u)}}function or(t,e,n,u){if(!(e==="key"||n==null||Ge(e)))if(e[0]==="o"&&e[1]==="n")Ze(t,e,void 0);else if(e==="style")Ye(t.dom,n,null);else if(Xe(t,e,u)&&e!=="className"&&e!=="title"&&!(e==="value"&&(t.tag==="option"||t.tag==="select"&&t.dom.selectedIndex===-1&&t.dom===d(t.dom)))&&!(t.tag==="input"&&e==="type"))t.dom[e]=null;else{var l=e.indexOf(":");l!==-1&&(e=e.slice(l+1)),n!==!1&&t.dom.removeAttribute(e==="className"?"class":e)}}function lr(t,e){if("value"in e)if(e.value===null)t.dom.selectedIndex!==-1&&(t.dom.value=null);else{var n=""+e.value;(t.dom.value!==n||t.dom.selectedIndex===-1)&&(t.dom.value=n)}"selectedIndex"in e&&Ie(t,"selectedIndex",null,e.selectedIndex,void 0)}function hr(t,e,n,u){var l;if(e!=null){e===n&&!yt.has(n)&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major");for(var m in e)(l=e[m])!=null&&(n==null||n[m]==null)&&or(t,m,l,u)}if(n!=null)for(var m in n)Ie(t,m,e&&e[m],n[m],u)}function pr(t,e){return e==="value"||e==="checked"||e==="selectedIndex"||e==="selected"&&(t.dom===d(t.dom)||t.tag==="option"&&t.dom.parentNode===d(t.dom))}function Ge(t){return t==="oninit"||t==="oncreate"||t==="onupdate"||t==="onremove"||t==="onbeforeremove"||t==="onbeforeupdate"}function Xe(t,e,n){return n===void 0&&(t.tag.indexOf("-")>-1||t.is||e!=="href"&&e!=="list"&&e!=="form"&&e!=="width"&&e!=="height")&&e in t.dom}function Ye(t,e,n){if(e!==n)if(n==null)t.style="";else if(typeof n!="object")t.style=n;else if(e==null||typeof e!="object"){t.style="";for(var u in n){var l=n[u];l!=null&&(u.includes("-")?t.style.setProperty(u,String(l)):t.style[u]=String(l))}}else{for(var u in e)e[u]!=null&&n[u]==null&&(u.includes("-")?t.style.removeProperty(u):t.style[u]="");for(var u in n){var l=n[u];l!=null&&(l=String(l))!==String(e[u])&&(u.includes("-")?t.style.setProperty(u,l):t.style[u]=l)}}}function Te(){this._=i}Te.prototype=Object.create(null),Te.prototype.handleEvent=function(t){var e=this["on"+t.type],n;typeof e=="function"?n=e.call(t.currentTarget,t):typeof e.handleEvent=="function"&&e.handleEvent(t);var u=this;u._!=null&&(t.redraw!==!1&&(0,u._)(),n!=null&&typeof n.then=="function"&&Promise.resolve(n).then(function(){u._!=null&&t.redraw!==!1&&(0,u._)()})),n===!1&&(t.preventDefault(),t.stopPropagation())};function Ze(t,e,n){if(t.events!=null){if(t.events._=i,t.events[e]===n)return;n!=null&&(typeof n=="function"||typeof n=="object")?(t.events[e]==null&&t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n):(t.events[e]!=null&&t.dom.removeEventListener(e.slice(2),t.events,!1),t.events[e]=void 0)}else n!=null&&(typeof n=="function"||typeof n=="object")&&(t.events=new Te,t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n)}function Se(t,e,n){typeof t.oninit=="function"&&c.call(t.oninit,e),typeof t.oncreate=="function"&&n.push(c.bind(t.oncreate,e))}function qe(t,e,n){typeof t.onupdate=="function"&&n.push(c.bind(t.onupdate,e))}function mr(t,e){do{if(t.attrs!=null&&typeof t.attrs.onbeforeupdate=="function"){var n=c.call(t.attrs.onbeforeupdate,t,e);if(n!==void 0&&!n)break}if(typeof t.tag!="string"&&typeof t.state.onbeforeupdate=="function"){var n=c.call(t.state.onbeforeupdate,t,e);if(n!==void 0&&!n)break}return!1}while(!1);return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,t.attrs=e.attrs,t.children=e.children,t.text=e.text,!0}var fe;return function(t,e,n){if(!t)throw new TypeError("DOM element being rendered to does not exist.");if(fe!=null&&t.contains(fe))throw new TypeError("Node is currently being rendered to and thus is locked.");var u=i,l=fe,m=[],S=d(t),j=t.namespaceURI;fe=t,i=typeof n=="function"?n:void 0,s={};try{t.vnodes==null&&(t.textContent=""),e=Le.normalizeChildren(Array.isArray(e)?e:[e]),B(t,t.vnodes,e,m,null,j==="http://www.w3.org/1999/xhtml"?void 0:j),t.vnodes=e,S!=null&&d(t)!==S&&typeof S.focus=="function"&&S.focus();for(var x=0;x<m.length;x++)m[x]()}finally{i=u,fe=l}}}});var Qe=A((Ii,It)=>{"use strict";It.exports=bt()(typeof window<"u"?window:null)});var qt=A((Ti,St)=>{"use strict";var Tt=J();St.exports=function(r,i,s){var a=[],f=!1,o=-1;function c(){for(o=0;o<a.length;o+=2)try{r(a[o],Tt(a[o+1]),d)}catch(h){s.error(h)}o=-1}function d(){f||(f=!0,i(function(){f=!1,c()}))}d.sync=c;function p(h,g){if(g!=null&&g.view==null&&typeof g!="function")throw new TypeError("m.mount expects a component, not a vnode.");var w=a.indexOf(h);w>=0&&(a.splice(w,2),w<=o&&(o-=2),r(h,[])),g!=null&&(a.push(h,g),r(h,Tt(g),d))}return{mount:p,redraw:d}}});var pe=A((Si,Ct)=>{"use strict";var $r=Qe();Ct.exports=qt()($r,typeof requestAnimationFrame<"u"?requestAnimationFrame:null,typeof console<"u"?console:null)});var Ve=A((qi,jt)=>{"use strict";jt.exports=function(r){if(Object.prototype.toString.call(r)!=="[object Object]")return"";var i=[];for(var s in r)a(s,r[s]);return i.join("&");function a(f,o){if(Array.isArray(o))for(var c=0;c<o.length;c++)a(f+"["+c+"]",o[c]);else if(Object.prototype.toString.call(o)==="[object Object]")for(var c in o)a(f+"["+c+"]",o[c]);else i.push(encodeURIComponent(f)+(o!=null&&o!==""?"="+encodeURIComponent(o):""))}}});var me=A((Ci,Ot)=>{"use strict";var Lr=Ve();Ot.exports=function(r,i){if(/:([^\/\.-]+)(\.{3})?:/.test(r))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(i==null)return r;var s=r.indexOf("?"),a=r.indexOf("#"),f=a<0?r.length:a,o=s<0?f:s,c=r.slice(0,o),d={};Object.assign(d,i);var p=c.replace(/:([^\/\.-]+)(\.{3})?/g,function(U,K,B){return delete d[K],i[K]==null?U:B?i[K]:encodeURIComponent(String(i[K]))}),h=p.indexOf("?"),g=p.indexOf("#"),w=g<0?p.length:g,q=h<0?w:h,y=p.slice(0,q);s>=0&&(y+=r.slice(s,f)),h>=0&&(y+=(s<0?"?":"&")+p.slice(h,w));var C=Lr(d);return C&&(y+=(s<0&&h<0?"?":"&")+C),a>=0&&(y+=r.slice(a)),g>=0&&(y+=(a<0?"":"&")+p.slice(g)),y}});var Et=A((ji,At)=>{"use strict";var Ur=me(),Rt=he();At.exports=function(r,i){function s(o){return new Promise(o)}function a(o,c){return new Promise(function(d,p){o=Ur(o,c.params);var h=c.method!=null?c.method.toUpperCase():"GET",g=c.body,w=(c.serialize==null||c.serialize===JSON.serialize)&&!(g instanceof r.FormData||g instanceof r.URLSearchParams),q=c.responseType||(typeof c.extract=="function"?"":"json"),y=new r.XMLHttpRequest,C=!1,U=!1,K=y,B,_=y.abort;y.abort=function(){C=!0,_.call(this)},y.open(h,o,c.async!==!1,typeof c.user=="string"?c.user:void 0,typeof c.password=="string"?c.password:void 0),w&&g!=null&&!f(c,"content-type")&&y.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof c.deserialize!="function"&&!f(c,"accept")&&y.setRequestHeader("Accept","application/json, text/*"),c.withCredentials&&(y.withCredentials=c.withCredentials),c.timeout&&(y.timeout=c.timeout),y.responseType=q;for(var M in c.headers)Rt.call(c.headers,M)&&y.setRequestHeader(M,c.headers[M]);y.onreadystatechange=function(b){if(!C&&b.target.readyState===4)try{var R=b.target.status>=200&&b.target.status<300||b.target.status===304||/^file:\/\//i.test(o),I=b.target.response,P;if(q==="json"){if(!b.target.responseType&&typeof c.extract!="function")try{I=JSON.parse(b.target.responseText)}catch{I=null}}else(!q||q==="text")&&I==null&&(I=b.target.responseText);if(typeof c.extract=="function"?(I=c.extract(b.target,c),R=!0):typeof c.deserialize=="function"&&(I=c.deserialize(I)),R){if(typeof c.type=="function")if(Array.isArray(I))for(var E=0;E<I.length;E++)I[E]=new c.type(I[E]);else I=new c.type(I);d(I)}else{var T=function(){try{P=b.target.responseText}catch{P=I}var D=new Error(P);D.code=b.target.status,D.response=I,p(D)};y.status===0?setTimeout(function(){U||T()}):T()}}catch(D){p(D)}},y.ontimeout=function(b){U=!0;var R=new Error("Request timed out");R.code=b.target.status,p(R)},typeof c.config=="function"&&(y=c.config(y,c,o)||y,y!==K&&(B=y.abort,y.abort=function(){C=!0,B.call(this)})),g==null?y.send():typeof c.serialize=="function"?y.send(c.serialize(g)):g instanceof r.FormData||g instanceof r.URLSearchParams?y.send(g):y.send(JSON.stringify(g))})}s.prototype=Promise.prototype,s.__proto__=Promise;function f(o,c){for(var d in o.headers)if(Rt.call(o.headers,d)&&d.toLowerCase()===c)return!0;return!1}return{request:function(o,c){typeof o!="string"?(c=o,o=o.url):c==null&&(c={});var d=a(o,c);if(c.background===!0)return d;var p=0;function h(){--p===0&&typeof i=="function"&&i()}return g(d);function g(w){var q=w.then;return w.constructor=s,w.then=function(){p++;var y=q.apply(w,arguments);return y.then(h,function(C){if(h(),p===0)throw C}),g(y)},w}}}}});var Mt=A((Oi,vt)=>{"use strict";var Qr=pe();vt.exports=Et()(typeof window<"u"?window:null,Qr.redraw)});var He=A((Ri,Nt)=>{"use strict";function zt(r){try{return decodeURIComponent(r)}catch{return r}}Nt.exports=function(r){if(r===""||r==null)return{};r.charAt(0)==="?"&&(r=r.slice(1));for(var i=r.split("&"),s={},a={},f=0;f<i.length;f++){var o=i[f].split("="),c=zt(o[0]),d=o.length===2?zt(o[1]):"";d==="true"?d=!0:d==="false"&&(d=!1);var p=c.split(/\]\[?|\[/),h=a;c.indexOf("[")>-1&&p.pop();for(var g=0;g<p.length;g++){var w=p[g],q=p[g+1],y=q==""||!isNaN(parseInt(q,10));if(w===""){var c=p.slice(0,g).join();s[c]==null&&(s[c]=Array.isArray(h)?h.length:0),w=s[c]++}else if(w==="__proto__")break;if(g===p.length-1)h[w]=d;else{var C=Object.getOwnPropertyDescriptor(h,w);C!=null&&(C=C.value),C==null&&(h[w]=C=y?[]:{}),h=C}}}return a}});var de=A((Ai,Ft)=>{"use strict";var Vr=He();Ft.exports=function(r){var i=r.indexOf("?"),s=r.indexOf("#"),a=s<0?r.length:s,f=i<0?a:i,o=r.slice(0,f).replace(/\/{2,}/g,"/");return o?o[0]!=="/"&&(o="/"+o):o="/",{path:o,params:i<0?{}:Vr(r.slice(i+1,a))}}});var Dt=A((Ei,Pt)=>{"use strict";var Hr=de();Pt.exports=function(r){var i=Hr(r),s=Object.keys(i.params),a=[],f=new RegExp("^"+i.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(o,c,d){return c==null?"\\"+o:(a.push({k:c,r:d==="..."}),d==="..."?"(.*)":d==="."?"([^/]+)\\.":"([^/]+)"+(d||""))})+"\\/?$");return function(o){for(var c=0;c<s.length;c++)if(i.params[s[c]]!==o.params[s[c]])return!1;if(!a.length)return f.test(o.path);var d=f.exec(o.path);if(d==null)return!1;for(var c=0;c<a.length;c++)o.params[a[c].k]=a[c].r?d[c+1]:decodeURIComponent(d[c+1]);return!0}}});var _e=A((vi,Ut)=>{"use strict";var $t=he(),Lt=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");Ut.exports=function(r,i){var s={};if(i!=null)for(var a in r)$t.call(r,a)&&!Lt.test(a)&&i.indexOf(a)<0&&(s[a]=r[a]);else for(var a in r)$t.call(r,a)&&!Lt.test(a)&&(s[a]=r[a]);return s}});var _t=A((Mi,Ht)=>{"use strict";var _r=J(),Br=Fe(),Qt=me(),Vt=de(),Kr=Dt(),kr=_e();function Jr(r){try{return decodeURIComponent(r)}catch{return r}}Ht.exports=function(r,i){var s=r==null?null:typeof r.setImmediate=="function"?r.setImmediate:r.setTimeout,a=Promise.resolve(),f=!1,o=!1,c=!1,d,p,h,g,w,q,y,C,U={onremove:function(){o=c=!1,r.removeEventListener("popstate",_,!1)},view:function(){var b=_r(w,q.key,q);return g?g.render(b):[b]}},K=M.SKIP={};function B(){f=!1;var b=r.location.hash;M.prefix[0]!=="#"&&(b=r.location.search+b,M.prefix[0]!=="?"&&(b=r.location.pathname+b,b[0]!=="/"&&(b="/"+b)));var R=b.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,Jr).slice(M.prefix.length),I=Vt(R);Object.assign(I.params,r.history.state);function P(T){console.error(T),M.set(h,null,{replace:!0})}E(0);function E(T){for(;T<p.length;T++)if(p[T].check(I)){var D=p[T].component,Z=p[T].route,ae=D,k=C=function(G){if(k===C){if(G===K)return E(T+1);w=G!=null&&(typeof G.view=="function"||typeof G=="function")?G:"div",q=I.params,y=R,C=null,g=D.render?D:null,c?i.redraw():(c=!0,i.mount(d,U))}};D.view||typeof D=="function"?(D={},k(ae)):D.onmatch?a.then(function(){return D.onmatch(I.params,R,Z)}).then(k,R===h?null:P):k();return}if(R===h)throw new Error("Could not resolve default route "+h+".");M.set(h,null,{replace:!0})}}function _(){f||(f=!0,s(B))}function M(b,R,I){if(!b)throw new TypeError("DOM element being rendered to does not exist.");if(p=Object.keys(I).map(function(E){if(E[0]!=="/")throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(E))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:E,component:I[E],check:Kr(E)}}),h=R,R!=null){var P=Vt(R);if(!p.some(function(E){return E.check(P)}))throw new ReferenceError("Default route doesn't match any known routes.")}d=b,r.addEventListener("popstate",_,!1),o=!0,B()}return M.set=function(b,R,I){if(C!=null&&(I=I||{},I.replace=!0),C=null,b=Qt(b,R),o){_();var P=I?I.state:null,E=I?I.title:null;I&&I.replace?r.history.replaceState(P,E,M.prefix+b):r.history.pushState(P,E,M.prefix+b)}else r.location.href=M.prefix+b},M.get=function(){return y},M.prefix="#!",M.Link={view:function(b){var R=Br(b.attrs.selector||"a",kr(b.attrs,["options","params","selector","onclick"]),b.children),I,P,E;return(R.attrs.disabled=!!R.attrs.disabled)?(R.attrs.href=null,R.attrs["aria-disabled"]="true"):(I=b.attrs.options,P=b.attrs.onclick,E=Qt(R.attrs.href,b.attrs.params),R.attrs.href=M.prefix+E,R.attrs.onclick=function(T){var D;typeof P=="function"?D=P.call(T.currentTarget,T):P==null||typeof P!="object"||typeof P.handleEvent=="function"&&P.handleEvent(T),D!==!1&&!T.defaultPrevented&&(T.button===0||T.which===0||T.which===1)&&(!T.currentTarget.target||T.currentTarget.target==="_self")&&!T.ctrlKey&&!T.metaKey&&!T.shiftKey&&!T.altKey&&(T.preventDefault(),T.redraw=!1,M.set(E,null,I))}),R}},M.param=function(b){return q&&b!=null?q[b]:q},M}});var Kt=A((zi,Bt)=>{"use strict";var Wr=pe();Bt.exports=_t()(typeof window<"u"?window:null,Wr)});var X=A((Ni,Jt)=>{"use strict";var ge=dt(),Gr=Mt(),kt=pe(),Xr=$e(),L=function(){return ge.apply(this,arguments)};L.m=ge;L.trust=ge.trust;L.fragment=ge.fragment;L.Fragment="[";L.mount=kt.mount;L.route=Kt();L.render=Qe();L.redraw=kt.redraw;L.request=Gr.request;L.parseQueryString=He();L.buildQueryString=Ve();L.parsePathname=de();L.buildPathname=me();L.vnode=J();L.censor=_e();L.domFor=Xr.domFor;Jt.exports=L});var se=ee(X());var we=ee(X());var Wt=ee(X()),Gt={view(){return(0,Wt.default)("p.logo","Tribbleation")}};var Ke=ee(X());var Be=ee(X());var Xt=`
const tdb = new TribbleDB($content).search({

});

return tdb;
`;var re=class{static getCode(){return localStorage.getItem("tribbleations.code")}static setCode(i){localStorage.setItem("tribbleations.code",i)}static getTribbles(){return localStorage.getItem("tribbleations.tribbles")}static setTribbles(i){localStorage.setItem("tribbleations.tribbles",i)}};var Zt=class{#e;#t;#r;constructor(){this.#e=0,this.#t=new Map,this.#r=new Map}map(){return this.#t}reverseMap(){return this.#r}add(r){return this.#t.has(r)?this.#t.get(r):(this.#t.set(r,this.#e),this.#r.set(this.#e,r),this.#e++,this.#e-1)}setIndex(r,i){this.#t.set(r,i),this.#r.set(i,r)}getIndex(r){return this.#t.get(r)}getValue(r){return this.#r.get(r)}has(r){return this.#t.has(r)}},er=class{static intersection(r,i){if(i.length===0)return new Set;i.sort((a,f)=>a.size-f.size);let s=new Set(i[0]);for(let a=1;a<i.length;a++){let f=i[a];for(let o of s)r.setCheck(),f.has(o)||s.delete(o);if(s.size===0)break}return s}},tr=class{stringIndex;constructor(){this.stringIndex=new Zt}parseTriple(r){let i=r.match(/^(\d+) (\d+) (\d+)$/);if(!i)throw new SyntaxError(`Invalid format for triple line: ${r}`);let s=this.stringIndex.getValue(parseInt(i[1],10)),a=this.stringIndex.getValue(parseInt(i[2],10)),f=this.stringIndex.getValue(parseInt(i[3],10));if(s===void 0||a===void 0||f===void 0)throw new SyntaxError(`Invalid triple reference: ${r}`);return[s,a,f]}parseDeclaration(r){let i=r.match(/^(\d+) "(.*)"$/);if(!i)throw new SyntaxError(`Invalid format for declaration line: ${r}`);let s=i[1],a=i[2];this.stringIndex.setIndex(a,parseInt(s,10))}parse(r){if(/^(\d+)\s(\d+)\s(\d+)$/.test(r))return this.parseTriple(r);this.parseDeclaration(r)}};function Yr(r,i="r\xF3"){if(!r.startsWith(`urn:${i}:`))throw new Error(`Invalid URN for namespace ${i}: ${r}`);let s=r.split(":")[2],[a,f]=r.split("?"),o=a.split(":")[3],c=f?Object.fromEntries(new URLSearchParams(f)):{};return{type:s,id:o,qs:c}}function Yt(r,i="r\xF3"){try{return Yr(r,i)}catch{return{type:"unknown",id:r,qs:{}}}}var Zr=class{mapReadCount;constructor(){this.mapReadCount=0}mapRead(){this.mapReadCount++}},ei=class{setCheckCount;constructor(){this.setCheckCount=0}setCheck(){this.setCheckCount++}},ti=class{indexedTriples;stringIndex;sourceType;sourceId;sourceQs;relations;targetType;targetId;targetQs;metrics;stringUrn;constructor(r){this.indexedTriples=[],this.stringIndex=new Zt,this.sourceType=new Map,this.sourceId=new Map,this.sourceQs=new Map,this.relations=new Map,this.targetType=new Map,this.targetId=new Map,this.targetQs=new Map,this.stringUrn=new Map,this.add(r),this.metrics=new Zr}add(r){let i=this.indexedTriples.length;for(let s=0;s<r.length;s++){let a=i+s,f=r[s],o=this.stringUrn.has(f[0])?this.stringUrn.get(f[0]):this.stringUrn.set(f[0],Yt(f[0])).get(f[0]),c=f[1],d=this.stringUrn.has(f[2])?this.stringUrn.get(f[2]):this.stringUrn.set(f[2],Yt(f[2])).get(f[2]),p=this.stringIndex.add(o.type),h=this.stringIndex.add(o.id),g=this.stringIndex.add(c),w=this.stringIndex.add(d.type),q=this.stringIndex.add(d.id);this.indexedTriples.push([this.stringIndex.add(f[0]),g,this.stringIndex.add(f[2])]),this.sourceType.has(p)||this.sourceType.set(p,new Set),this.sourceType.get(p).add(a),this.sourceId.has(h)||this.sourceId.set(h,new Set),this.sourceId.get(h).add(a);for(let[y,C]of Object.entries(o.qs)){let U=this.stringIndex.add(`${y}=${C}`);this.sourceQs.has(U)||this.sourceQs.set(U,new Set),this.sourceQs.get(U).add(a)}this.relations.has(g)||this.relations.set(g,new Set),this.relations.get(g).add(a),this.targetType.has(w)||this.targetType.set(w,new Set),this.targetType.get(w).add(a),this.targetId.has(q)||this.targetId.set(q,new Set),this.targetId.get(q).add(a);for(let[y,C]of Object.entries(d.qs)){let U=this.stringIndex.add(`${y}=${C}`);this.targetQs.has(U)||this.targetQs.set(U,new Set),this.targetQs.get(U).add(a)}}}get length(){return this.indexedTriples.length}triples(){return this.indexedTriples.map(([r,i,s])=>[this.stringIndex.getValue(r),this.stringIndex.getValue(i),this.stringIndex.getValue(s)])}getTriple(r){if(r<0||r>=this.indexedTriples.length)return;let[i,s,a]=this.indexedTriples[r];return[this.stringIndex.getValue(i),this.stringIndex.getValue(s),this.stringIndex.getValue(a)]}getTripleIndices(r){if(!(r<0||r>=this.indexedTriples.length))return this.indexedTriples[r]}getSourceTypeSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.sourceType.get(i)}getSourceIdSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.sourceId.get(i)}getSourceQsSet(r,i){let s=this.stringIndex.getIndex(`${r}=${i}`);if(s!==void 0)return this.metrics.mapRead(),this.sourceQs.get(s)}getRelationSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.relations.get(i)}getTargetTypeSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.targetType.get(i)}getTargetIdSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.targetId.get(i)}getTargetQsSet(r,i){let s=this.stringIndex.getIndex(`${r}=${i}`);if(s!==void 0)return this.metrics.mapRead(),this.targetQs.get(s)}},W=class{static source(r){return r[0]}static relation(r){return r[1]}static target(r){return r[2]}};function ri(r,i,s){let a=i.names.concat(s.names);if(i.rows.length===0||s.rows.length===0)return{names:a,rows:[]};let f=new Map,o=new Map;for(let p=0;p<i.rows.length;p++){let h=i.rows[p][2];f.has(h)||f.set(h,[]),f.get(h).push(p)}for(let p=0;p<s.rows.length;p++){let h=s.rows[p][0];o.has(h)||o.set(h,[]),o.get(h).push(p)}let c=er.intersection(r,[new Set(f.keys()),new Set(o.keys())]),d=[];for(let p of c){let h=o.get(p),g=f.get(p);for(let w of h)for(let q of g){let y=i.rows[w].concat(s.rows[q]);d.push(y)}}return{names:a,rows:d}}var rr=class ie{index;triplesCount;cursorIndices;metrics;constructor(i){this.index=new ti(i),this.triplesCount=this.index.length,this.cursorIndices=new Set,this.metrics=new ei;for(let s=0;s<this.triplesCount;s++)this.cursorIndices.add(s)}clone(){let i=new ie([]);return i.index=this.index,i.triplesCount=this.triplesCount,i.cursorIndices=this.cursorIndices,i.metrics=this.metrics,i}static of(i){return new ie(i)}static from(i){let s=[];for(let a of i){let{id:f,...o}=a;if(typeof f!="string")throw new Error("Each TripleObject must have a string id.");for(let[c,d]of Object.entries(o))if(Array.isArray(d))for(let p of d)s.push([f,c,p]);else s.push([f,c,d])}return new ie(s)}add(i){let s=this.index.length;this.index.add(i),this.triplesCount=this.index.length;for(let a=s;a<this.triplesCount;a++)this.cursorIndices.add(a)}map(i){return new ie(this.index.triples().map(i))}flatMap(i){let s=this.index.triples().flatMap(i);return new ie(s)}firstTriple(){return this.index.length>0?this.index.getTriple(0):void 0}firstSource(){let i=this.firstTriple();return i?W.source(i):void 0}firstRelation(){let i=this.firstTriple();return i?W.relation(i):void 0}firstTarget(){let i=this.firstTriple();return i?W.target(i):void 0}firstObject(i=!1){return this.objects(i)[0]}triples(){return this.index.triples()}sources(){return new Set(this.index.triples().map(W.source))}relations(){return new Set(this.index.triples().map(W.relation))}targets(){return new Set(this.index.triples().map(W.target))}objects(i=!1){let s=[];for(let[a,f]of Object.entries(this.object(i)))f.id=a,s.push(f);return s}object(i=!1){let s={};for(let[a,f,o]of this.index.triples())s[a]||(s[a]={id:a}),s[a][f]?Array.isArray(s[a][f])?s[a][f].push(o):s[a][f]=[s[a][f],o]:s[a][f]=i?[o]:o;return s}#e(i){let s=[this.cursorIndices],{source:a,relation:f,target:o}=i;if(typeof a>"u"&&typeof o>"u"&&typeof f>"u")throw new Error("At least one search parameter must be defined");let c=["source","relation","target"];for(let h of Object.keys(i))if(Object.prototype.hasOwnProperty.call(i,h)&&!c.includes(h))throw new Error(`Unexpected search parameter: ${h}`);if(a){if(a.type){let h=this.index.getSourceTypeSet(a.type);if(h)s.push(h);else return new Set}if(a.id){let h=this.index.getSourceIdSet(a.id);if(h)s.push(h);else return new Set}if(a.qs)for(let[h,g]of Object.entries(a.qs)){let w=this.index.getSourceQsSet(h,g);if(w)s.push(w);else return new Set}}if(o){if(o.type){let h=this.index.getTargetTypeSet(o.type);if(h)s.push(h);else return new Set}if(o.id){let h=this.index.getTargetIdSet(o.id);if(h)s.push(h);else return new Set}if(o.qs)for(let[h,g]of Object.entries(o.qs)){let w=this.index.getTargetQsSet(h,g);if(w)s.push(w);else return new Set}}if(f){let h=typeof f=="string"?{relation:[f]}:f;if(h.relation){let g=new Set;for(let w of h.relation){let q=this.index.getRelationSet(w);if(q)for(let y of q)g.add(y)}if(g.size>0)s.push(g);else return new Set}}let d=er.intersection(this.metrics,s),p=new Set;for(let h of d){let g=this.index.getTriple(h);if(!a?.predicate&&!o?.predicate&&!(typeof f=="object"&&f.predicate)){p.add(h);continue}let w=!0;a?.predicate&&(w=w&&a.predicate(W.source(g))),o?.predicate&&(w=w&&o.predicate(W.target(g))),typeof f=="object"&&f.predicate&&(w=w&&f.predicate(W.relation(g))),w&&p.add(h)}return p}search(i){let s=[];for(let a of this.#e(i)){let f=this.index.getTriple(a);f&&s.push(f)}return new ie(s)}search2(i){let s=Object.entries(i),a=[];for(let d=0;d<s.length-2;d+=2){let p=s.slice(d,d+3),h={source:p[0][1],relation:p[1][1],target:p[2][1]},g=p.map(y=>y[0]),w=this.#e(h),q=Array.from(w).flatMap(y=>{let C=this.index.getTripleIndices(y);return typeof C>"u"?[]:[C]});a.push({names:g,rows:q})}let f=a.reduce(ri.bind(this,this.metrics)),o=f.names,c=[];for(let d of f.rows){let p={};for(let h=0;h<o.length;h++){let g=o[h];p[g]=this.index.stringIndex.getValue(d[h])}c.push(p)}return c}getMetrics(){return{index:this.index.metrics,db:this.metrics}}};var z={code:re.getCode()??Xt,codeFailure:"",results:nr(re.getTribbles()??"")??[],objects:[]};function ii(r){try{return new Function(r),null}catch(i){return i}}function ni(r){let i=r.target;z.code=i.value,re.setCode(z.code);let s=ii(z.code);s?(console.error("failed to parse code"),z.codeFailure=`Failed to parse code: ${s.message}`):z.codeFailure="";let a=ir(z.results);z.objects=a??[],Be.default.redraw()}function si(r){return new Promise((i,s)=>{let a=new FileReader;a.onload=f=>{let o=f.target?.result;i(o)},a.readAsText(r)})}function ai(r){try{return new Function("$content","TribbleDB",z.code)(r,rr)}catch(i){console.error("failed to execute code",i),z.codeFailure=`Failed to execute code: ${i.message}`;return}}function ir(r){let i=ai(r);if(!i||!i.objects){z.codeFailure="Code did not return a TribbleDB object",z.objects=[];return}return i.objects()}function nr(r){if(!r)return;let i=new tr,s=[];for(let a of r.split(`
`)){if(!a)continue;let f=i.parse(a);f&&s.push(f)}return s}async function ui(r){let i=r.target;if(!i.files||i.files.length===0)return;let[s]=i.files,a=await si(s);re.setTribbles(a);let f=nr(a);typeof f<"u"&&(z.results=f);let o=ir(z.results);z.objects=o??[],Be.default.redraw()}var ye={updateCode(r){return ni(r)},async onFileChange(r){return await ui(r)}};var sr={view(){return(0,Ke.default)("div.workspace",[(0,Ke.default)("input.workspace[type=file]",{onchange:ye.onFileChange})])}};var ar={view(){return(0,we.default)("header",[(0,we.default)(Gt),(0,we.default)(sr)])}};var xe=ee(X());var ur={view(){return(0,xe.default)("div.editor-container",[(0,xe.default)("p#error",z.codeFailure),(0,xe.default)("textarea.editor",{value:z.code,spellcheck:!1,onkeyup:ye.updateCode})])}};var Y=ee(X());var fr={view(){let r=z.objects.length>0?Object.keys(z.objects[0]):[],i=z.objects.map(s=>r.map(a=>s[a]??""));if(z.objects.length>0)return(0,Y.default)("div.output",[(0,Y.default)("h3",`Output ${z.objects.length} rows`),(0,Y.default)("table",[(0,Y.default)("tr",r.map(s=>(0,Y.default)("th",s))),...i.map(s=>(0,Y.default)("tr",s.map(a=>(0,Y.default)("td",a))))])])}};var fi={view(){return(0,se.default)("div.grid",[(0,se.default)(ar),(0,se.default)(ur),(0,se.default)(fr)])}};se.default.mount(document.body,fi);
//# sourceMappingURL=app.js.map
