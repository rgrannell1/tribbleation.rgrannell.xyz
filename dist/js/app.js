var gr=Object.create;var rt=Object.defineProperty;var wr=Object.getOwnPropertyDescriptor;var yr=Object.getOwnPropertyNames;var xr=Object.getPrototypeOf,br=Object.prototype.hasOwnProperty;var E=(r,i)=>()=>(i||r((i={exports:{}}).exports,i),i.exports);var Ir=(r,i,s,a)=>{if(i&&typeof i=="object"||typeof i=="function")for(let o of yr(i))!br.call(r,o)&&o!==s&&rt(r,o,{get:()=>i[o],enumerable:!(a=wr(i,o))||a.enumerable});return r};var ee=(r,i,s)=>(s=r!=null?gr(xr(r)):{},Ir(i||!r||!r.__esModule?rt(s,"default",{value:r,enumerable:!0}):s,r));var W=E((pi,it)=>{"use strict";function te(r,i,s,a,o,c){return{tag:r,key:i,attrs:s,children:a,text:o,dom:c,is:void 0,domSize:void 0,state:void 0,events:void 0,instance:void 0}}te.normalize=function(r){return Array.isArray(r)?te("[",void 0,void 0,te.normalizeChildren(r),void 0,void 0):r==null||typeof r=="boolean"?null:typeof r=="object"?r:te("#",void 0,void 0,String(r),void 0,void 0)};te.normalizeChildren=function(r){var i=[];if(r.length){for(var s=r[0]!=null&&r[0].key!=null,a=1;a<r.length;a++)if((r[a]!=null&&r[a].key!=null)!==s)throw new TypeError(s&&(r[a]==null||typeof r[a]=="boolean")?"In fragments, vnodes must either all have keys or none have keys. You may wish to consider using an explicit keyed empty fragment, m.fragment({key: ...}), instead of a hole.":"In fragments, vnodes must either all have keys or none have keys.");for(var a=0;a<r.length;a++)i[a]=te.normalize(r[a])}return i};it.exports=te});var ve=E((mi,nt)=>{"use strict";var Tr=W();nt.exports=function(r,i){return r==null||typeof r=="object"&&r.tag==null&&!Array.isArray(r)?i.length===1&&Array.isArray(i[0])&&(i=i[0]):(i=i.length===0&&Array.isArray(r)?r:[r,...i],r=void 0),Tr("",r&&r.key,r,i)}});var he=E((di,st)=>{"use strict";st.exports={}.hasOwnProperty});var Me=E((gi,at)=>{"use strict";at.exports={}});var Fe=E((wi,ut)=>{"use strict";var Sr=Me();ut.exports=new Map([[Sr,!0]])});var Ne=E((yi,ct)=>{"use strict";var qr=W(),jr=ve(),ze=he(),ot=Me(),Cr=Fe(),Or=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,ft=Object.create(null);function Rr(r){for(var i in r)if(ze.call(r,i))return!1;return!0}function Ar(r){return r==="value"||r==="checked"||r==="selectedIndex"||r==="selected"}function Er(r){for(var i,s="div",a=[],o={},c=!0;i=Or.exec(r);){var f=i[1],d=i[2];if(f===""&&d!=="")s=d;else if(f==="#")o.id=d;else if(f===".")a.push(d);else if(i[3][0]==="["){var p=i[6];p&&(p=p.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),i[4]==="class"?a.push(p):(o[i[4]]=p===""?p:p||!0,Ar(i[4])&&(c=!1))}}return a.length>0&&(o.className=a.join(" ")),Rr(o)?o=ot:Cr.set(o,c),ft[r]={tag:s,attrs:o,is:o.is}}function vr(r,i){i.tag=r.tag;var s=i.attrs;if(s==null)return i.attrs=r.attrs,i.is=r.is,i;var a=ze.call(s,"class"),o=a?s.class:s.className;return r.attrs!==ot?(s=Object.assign({},r.attrs,s),(o!=null||r.attrs.className!=null)&&(s.className=o!=null?r.attrs.className!=null?String(r.attrs.className)+" "+String(o):o:r.attrs.className)):o!=null&&(s.className=o),a&&(s.class=null),r.tag==="input"&&ze.call(s,"type")&&(s=Object.assign({type:s.type},s)),i.is=s.is,i.attrs=s,i}function Mr(r,i,...s){if(r==null||typeof r!="string"&&typeof r!="function"&&typeof r.view!="function")throw Error("The selector must be either a string or a component.");var a=jr(i,s);return typeof r=="string"&&(a.children=qr.normalizeChildren(a.children),r!=="[")?vr(ft[r]||Er(r),a):(a.attrs==null&&(a.attrs={}),a.tag=r,a)}ct.exports=Mr});var ht=E((xi,lt)=>{"use strict";var Fr=W();lt.exports=function(r){return r==null&&(r=""),Fr("<",void 0,void 0,r,void 0,void 0)}});var mt=E((bi,pt)=>{"use strict";var zr=W(),Nr=ve();pt.exports=function(r,...i){var s=Nr(r,i);return s.attrs==null&&(s.attrs={}),s.tag="[",s.children=zr.normalizeChildren(s.children),s}});var gt=E((Ii,dt)=>{"use strict";var Pe=Ne();Pe.trust=ht();Pe.fragment=mt();dt.exports=Pe});var $e=E((Ti,wt)=>{"use strict";var De=new WeakMap;function*Pr(r){var i=r.dom,s=r.domSize,a=De.get(i);if(i!=null)do{var o=i.nextSibling;De.get(i)===a&&(yield i,s--),i=o}while(s)}wt.exports={delayedRemoval:De,domFor:Pr}});var It=E((Si,bt)=>{"use strict";var Le=W(),xt=$e(),Dr=xt.delayedRemoval,Ue=xt.domFor,yt=Fe();bt.exports=function(){var r={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},i,s;function a(t){return t.ownerDocument}function o(t){return t.attrs&&t.attrs.xmlns||r[t.tag]}function c(t,e){if(t.state!==e)throw new Error("'vnode.state' must not be modified.")}function f(t){var e=t.state;try{return this.apply(e,arguments)}finally{c(t,e)}}function d(t){try{return a(t).activeElement}catch{return null}}function p(t,e,n,u,l,m,S){for(var C=n;C<u;C++){var x=e[C];x!=null&&h(t,x,l,S,m)}}function h(t,e,n,u,l){var m=e.tag;if(typeof m=="string")switch(e.state={},e.attrs!=null&&Se(e.attrs,e,n),m){case"#":g(t,e,l);break;case"<":q(t,e,u,l);break;case"[":w(t,e,n,u,l);break;default:j(t,e,n,u,l)}else k(t,e,n,u,l)}function g(t,e,n){e.dom=a(t).createTextNode(e.children),J(t,e.dom,n)}var y={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"};function q(t,e,n,u){var l=e.children.match(/^\s*?<(\w+)/im)||[],m=a(t).createElement(y[l[1]]||"div");n==="http://www.w3.org/2000/svg"?(m.innerHTML='<svg xmlns="http://www.w3.org/2000/svg">'+e.children+"</svg>",m=m.firstChild):m.innerHTML=e.children,e.dom=m.firstChild,e.domSize=m.childNodes.length;for(var S=a(t).createDocumentFragment(),C;C=m.firstChild;)S.appendChild(C);J(t,S,u)}function w(t,e,n,u,l){var m=a(t).createDocumentFragment();if(e.children!=null){var S=e.children;p(m,S,0,S.length,n,null,u)}e.dom=m.firstChild,e.domSize=m.childNodes.length,J(t,m,l)}function j(t,e,n,u,l){var m=e.tag,S=e.attrs,C=e.is;u=o(e)||u;var x=u?C?a(t).createElementNS(u,m,{is:C}):a(t).createElementNS(u,m):C?a(t).createElement(m,{is:C}):a(t).createElement(m);if(e.dom=x,S!=null&&fr(e,S,u),J(t,x,l),!X(e)&&e.children!=null){var R=e.children;p(x,R,0,R.length,n,null,u),e.tag==="select"&&S!=null&&lr(e,S)}}function U(t,e){var n;if(typeof t.tag.view=="function"){if(t.state=Object.create(t.tag),n=t.state.view,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0}else{if(t.state=void 0,n=t.tag,n.$$reentrantLock$$!=null)return;n.$$reentrantLock$$=!0,t.state=t.tag.prototype!=null&&typeof t.tag.prototype.view=="function"?new t.tag(t):t.tag(t)}if(Se(t.state,t,e),t.attrs!=null&&Se(t.attrs,t,e),t.instance=Le.normalize(f.call(t.state.view,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");n.$$reentrantLock$$=null}function k(t,e,n,u,l){U(e,n),e.instance!=null?(h(t,e.instance,n,u,l),e.dom=e.instance.dom,e.domSize=e.dom!=null?e.instance.domSize:0):e.domSize=0}function K(t,e,n,u,l,m){if(!(e===n||e==null&&n==null))if(e==null||e.length===0)p(t,n,0,n.length,u,l,m);else if(n==null||n.length===0)ue(t,e,0,e.length);else{var S=e[0]!=null&&e[0].key!=null,C=n[0]!=null&&n[0].key!=null,x=0,R=0;if(!S)for(;R<e.length&&e[R]==null;)R++;if(!C)for(;x<n.length&&n[x]==null;)x++;if(S!==C)ue(t,e,R,e.length),p(t,n,x,n.length,u,l,m);else if(C){for(var V=e.length-1,$=n.length-1,le,H,N,Q,M,Ce;V>=R&&$>=x&&(Q=e[V],M=n[$],Q.key===M.key);)Q!==M&&_(t,Q,M,u,l,m),M.dom!=null&&(l=M.dom),V--,$--;for(;V>=R&&$>=x&&(H=e[R],N=n[x],H.key===N.key);)R++,x++,H!==N&&_(t,H,N,u,Z(e,R,l),m);for(;V>=R&&$>=x&&!(x===$||H.key!==M.key||Q.key!==N.key);)Ce=Z(e,R,l),ae(t,Q,Ce),Q!==N&&_(t,Q,N,u,Ce,m),++x<=--$&&ae(t,H,l),H!==M&&_(t,H,M,u,l,m),M.dom!=null&&(l=M.dom),R++,V--,Q=e[V],M=n[$],H=e[R],N=n[x];for(;V>=R&&$>=x&&Q.key===M.key;)Q!==M&&_(t,Q,M,u,l,m),M.dom!=null&&(l=M.dom),V--,$--,Q=e[V],M=n[$];if(x>$)ue(t,e,R,V+1);else if(R>V)p(t,n,x,$+1,u,l,m);else{var dr=l,tt=$-x+1,fe=new Array(tt),Oe=0,z=0,Re=2147483647,Ae=0,le,Ee;for(z=0;z<tt;z++)fe[z]=-1;for(z=$;z>=x;z--){le==null&&(le=v(e,R,V+1)),M=n[z];var ne=le[M.key];ne!=null&&(Re=ne<Re?ne:-1,fe[z-x]=ne,Q=e[ne],e[ne]=null,Q!==M&&_(t,Q,M,u,l,m),M.dom!=null&&(l=M.dom),Ae++)}if(l=dr,Ae!==V-R+1&&ue(t,e,R,V+1),Ae===0)p(t,n,x,$+1,u,l,m);else if(Re===-1)for(Ee=D(fe),Oe=Ee.length-1,z=$;z>=x;z--)N=n[z],fe[z-x]===-1?h(t,N,u,m,l):Ee[Oe]===z-x?Oe--:ae(t,N,l),N.dom!=null&&(l=n[z].dom);else for(z=$;z>=x;z--)N=n[z],fe[z-x]===-1&&h(t,N,u,m,l),N.dom!=null&&(l=n[z].dom)}}else{var je=e.length<n.length?e.length:n.length;for(x=x<R?x:R;x<je;x++)H=e[x],N=n[x],!(H===N||H==null&&N==null)&&(H==null?h(t,N,u,m,Z(e,x+1,l)):N==null?ce(t,H):_(t,H,N,u,Z(e,x+1,l),m));e.length>je&&ue(t,e,x,e.length),n.length>je&&p(t,n,x,n.length,u,l,m)}}}function _(t,e,n,u,l,m){var S=e.tag,C=n.tag;if(S===C&&e.is===n.is){if(n.state=e.state,n.events=e.events,mr(n,e))return;if(typeof S=="string")switch(n.attrs!=null&&qe(n.attrs,n,u),S){case"#":F(e,n);break;case"<":b(t,e,n,m,l);break;case"[":A(t,e,n,u,l,m);break;default:I(e,n,u,m)}else P(t,e,n,u,l,m)}else ce(t,e),h(t,n,u,m,l)}function F(t,e){t.children.toString()!==e.children.toString()&&(t.dom.nodeValue=e.children),e.dom=t.dom}function b(t,e,n,u,l){e.children!==n.children?(Ge(t,e),q(t,n,u,l)):(n.dom=e.dom,n.domSize=e.domSize)}function A(t,e,n,u,l,m){K(t,e.children,n.children,u,l,m);var S=0,C=n.children;if(n.dom=null,C!=null){for(var x=0;x<C.length;x++){var R=C[x];R!=null&&R.dom!=null&&(n.dom==null&&(n.dom=R.dom),S+=R.domSize||1)}S!==1&&(n.domSize=S)}}function I(t,e,n,u){var l=e.dom=t.dom;u=o(e)||u,(t.attrs!=e.attrs||e.attrs!=null&&!yt.get(e.attrs))&&hr(e,t.attrs,e.attrs,u),X(e)||K(l,t.children,e.children,n,null,u)}function P(t,e,n,u,l,m){if(n.instance=Le.normalize(f.call(n.state.view,n)),n.instance===n)throw Error("A view cannot return the vnode it received as argument");qe(n.state,n,u),n.attrs!=null&&qe(n.attrs,n,u),n.instance!=null?(e.instance==null?h(t,n.instance,u,m,l):_(t,e.instance,n.instance,u,l,m),n.dom=n.instance.dom,n.domSize=n.instance.domSize):e.instance!=null?(ce(t,e.instance),n.dom=void 0,n.domSize=0):(n.dom=e.dom,n.domSize=e.domSize)}function v(t,e,n){for(var u=Object.create(null);e<n;e++){var l=t[e];if(l!=null){var m=l.key;m!=null&&(u[m]=e)}}return u}var T=[];function D(t){for(var e=[0],n=0,u=0,l=0,m=T.length=t.length,l=0;l<m;l++)T[l]=t[l];for(var l=0;l<m;++l)if(t[l]!==-1){var S=e[e.length-1];if(t[S]<t[l]){T[l]=S,e.push(l);continue}for(n=0,u=e.length-1;n<u;){var C=(n>>>1)+(u>>>1)+(n&u&1);t[e[C]]<t[l]?n=C+1:u=C}t[l]<t[e[n]]&&(n>0&&(T[l]=e[n-1]),e[n]=l)}for(n=e.length,u=e[n-1];n-- >0;)e[n]=u,u=T[u];return T.length=0,e}function Z(t,e,n){for(;e<t.length;e++)if(t[e]!=null&&t[e].dom!=null)return t[e].dom;return n}function ae(t,e,n){if(e.dom!=null){var u;if(e.domSize==null)u=e.dom;else{u=a(t).createDocumentFragment();for(var l of Ue(e))u.appendChild(l)}J(t,u,n)}}function J(t,e,n){n!=null?t.insertBefore(e,n):t.appendChild(e)}function X(t){if(t.attrs==null||t.attrs.contenteditable==null&&t.attrs.contentEditable==null)return!1;var e=t.children;if(e!=null&&e.length===1&&e[0].tag==="<"){var n=e[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(e!=null&&e.length!==0)throw new Error("Child node of a contenteditable must be trusted.");return!0}function ue(t,e,n,u){for(var l=n;l<u;l++){var m=e[l];m!=null&&ce(t,m)}}function Je(t,e,n,u){var l=e.state,m=f.call(n.onbeforeremove,e);if(m!=null){var S=s;for(var C of Ue(e))Dr.set(C,S);u.v++,Promise.resolve(m).finally(function(){c(e,l),We(t,e,u)})}}function We(t,e,n){--n.v===0&&(be(e),Ge(t,e))}function ce(t,e){var n={v:1};typeof e.tag!="string"&&typeof e.state.onbeforeremove=="function"&&Je(t,e,e.state,n),e.attrs&&typeof e.attrs.onbeforeremove=="function"&&Je(t,e,e.attrs,n),We(t,e,n)}function Ge(t,e){if(e.dom!=null)if(e.domSize==null)t.removeChild(e.dom);else for(var n of Ue(e))t.removeChild(n)}function be(t){if(typeof t.tag!="string"&&typeof t.state.onremove=="function"&&f.call(t.state.onremove,t),t.attrs&&typeof t.attrs.onremove=="function"&&f.call(t.attrs.onremove,t),typeof t.tag!="string")t.instance!=null&&be(t.instance);else{t.events!=null&&(t.events._=null);var e=t.children;if(Array.isArray(e))for(var n=0;n<e.length;n++){var u=e[n];u!=null&&be(u)}}}function fr(t,e,n){for(var u in e)Ie(t,u,null,e[u],n)}function Ie(t,e,n,u,l){if(!(e==="key"||u==null||Xe(e)||n===u&&!pr(t,e)&&typeof u!="object")){if(e[0]==="o"&&e[1]==="n")return et(t,e,u);if(e.slice(0,6)==="xlink:")t.dom.setAttributeNS("http://www.w3.org/1999/xlink",e.slice(6),u);else if(e==="style")Ze(t.dom,n,u);else if(Ye(t,e,l)){if(e==="value"){if((t.tag==="input"||t.tag==="textarea")&&t.dom.value===""+u||t.tag==="select"&&n!==null&&t.dom.value===""+u||t.tag==="option"&&n!==null&&t.dom.value===""+u)return;if(t.tag==="input"&&t.attrs.type==="file"&&""+u!=""){console.error("`value` is read-only on file inputs!");return}}t.tag==="input"&&e==="type"?t.dom.setAttribute(e,u):t.dom[e]=u}else typeof u=="boolean"?u?t.dom.setAttribute(e,""):t.dom.removeAttribute(e):t.dom.setAttribute(e==="className"?"class":e,u)}}function cr(t,e,n,u){if(!(e==="key"||n==null||Xe(e)))if(e[0]==="o"&&e[1]==="n")et(t,e,void 0);else if(e==="style")Ze(t.dom,n,null);else if(Ye(t,e,u)&&e!=="className"&&e!=="title"&&!(e==="value"&&(t.tag==="option"||t.tag==="select"&&t.dom.selectedIndex===-1&&t.dom===d(t.dom)))&&!(t.tag==="input"&&e==="type"))t.dom[e]=null;else{var l=e.indexOf(":");l!==-1&&(e=e.slice(l+1)),n!==!1&&t.dom.removeAttribute(e==="className"?"class":e)}}function lr(t,e){if("value"in e)if(e.value===null)t.dom.selectedIndex!==-1&&(t.dom.value=null);else{var n=""+e.value;(t.dom.value!==n||t.dom.selectedIndex===-1)&&(t.dom.value=n)}"selectedIndex"in e&&Ie(t,"selectedIndex",null,e.selectedIndex,void 0)}function hr(t,e,n,u){var l;if(e!=null){e===n&&!yt.has(n)&&console.warn("Don't reuse attrs object, use new object for every redraw, this will throw in next major");for(var m in e)(l=e[m])!=null&&(n==null||n[m]==null)&&cr(t,m,l,u)}if(n!=null)for(var m in n)Ie(t,m,e&&e[m],n[m],u)}function pr(t,e){return e==="value"||e==="checked"||e==="selectedIndex"||e==="selected"&&(t.dom===d(t.dom)||t.tag==="option"&&t.dom.parentNode===d(t.dom))}function Xe(t){return t==="oninit"||t==="oncreate"||t==="onupdate"||t==="onremove"||t==="onbeforeremove"||t==="onbeforeupdate"}function Ye(t,e,n){return n===void 0&&(t.tag.indexOf("-")>-1||t.is||e!=="href"&&e!=="list"&&e!=="form"&&e!=="width"&&e!=="height")&&e in t.dom}function Ze(t,e,n){if(e!==n)if(n==null)t.style="";else if(typeof n!="object")t.style=n;else if(e==null||typeof e!="object"){t.style="";for(var u in n){var l=n[u];l!=null&&(u.includes("-")?t.style.setProperty(u,String(l)):t.style[u]=String(l))}}else{for(var u in e)e[u]!=null&&n[u]==null&&(u.includes("-")?t.style.removeProperty(u):t.style[u]="");for(var u in n){var l=n[u];l!=null&&(l=String(l))!==String(e[u])&&(u.includes("-")?t.style.setProperty(u,l):t.style[u]=l)}}}function Te(){this._=i}Te.prototype=Object.create(null),Te.prototype.handleEvent=function(t){var e=this["on"+t.type],n;typeof e=="function"?n=e.call(t.currentTarget,t):typeof e.handleEvent=="function"&&e.handleEvent(t);var u=this;u._!=null&&(t.redraw!==!1&&(0,u._)(),n!=null&&typeof n.then=="function"&&Promise.resolve(n).then(function(){u._!=null&&t.redraw!==!1&&(0,u._)()})),n===!1&&(t.preventDefault(),t.stopPropagation())};function et(t,e,n){if(t.events!=null){if(t.events._=i,t.events[e]===n)return;n!=null&&(typeof n=="function"||typeof n=="object")?(t.events[e]==null&&t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n):(t.events[e]!=null&&t.dom.removeEventListener(e.slice(2),t.events,!1),t.events[e]=void 0)}else n!=null&&(typeof n=="function"||typeof n=="object")&&(t.events=new Te,t.dom.addEventListener(e.slice(2),t.events,!1),t.events[e]=n)}function Se(t,e,n){typeof t.oninit=="function"&&f.call(t.oninit,e),typeof t.oncreate=="function"&&n.push(f.bind(t.oncreate,e))}function qe(t,e,n){typeof t.onupdate=="function"&&n.push(f.bind(t.onupdate,e))}function mr(t,e){do{if(t.attrs!=null&&typeof t.attrs.onbeforeupdate=="function"){var n=f.call(t.attrs.onbeforeupdate,t,e);if(n!==void 0&&!n)break}if(typeof t.tag!="string"&&typeof t.state.onbeforeupdate=="function"){var n=f.call(t.state.onbeforeupdate,t,e);if(n!==void 0&&!n)break}return!1}while(!1);return t.dom=e.dom,t.domSize=e.domSize,t.instance=e.instance,t.attrs=e.attrs,t.children=e.children,t.text=e.text,!0}var oe;return function(t,e,n){if(!t)throw new TypeError("DOM element being rendered to does not exist.");if(oe!=null&&t.contains(oe))throw new TypeError("Node is currently being rendered to and thus is locked.");var u=i,l=oe,m=[],S=d(t),C=t.namespaceURI;oe=t,i=typeof n=="function"?n:void 0,s={};try{t.vnodes==null&&(t.textContent=""),e=Le.normalizeChildren(Array.isArray(e)?e:[e]),K(t,t.vnodes,e,m,null,C==="http://www.w3.org/1999/xhtml"?void 0:C),t.vnodes=e,S!=null&&d(t)!==S&&typeof S.focus=="function"&&S.focus();for(var x=0;x<m.length;x++)m[x]()}finally{i=u,oe=l}}}});var Qe=E((qi,Tt)=>{"use strict";Tt.exports=It()(typeof window<"u"?window:null)});var jt=E((ji,qt)=>{"use strict";var St=W();qt.exports=function(r,i,s){var a=[],o=!1,c=-1;function f(){for(c=0;c<a.length;c+=2)try{r(a[c],St(a[c+1]),d)}catch(h){s.error(h)}c=-1}function d(){o||(o=!0,i(function(){o=!1,f()}))}d.sync=f;function p(h,g){if(g!=null&&g.view==null&&typeof g!="function")throw new TypeError("m.mount expects a component, not a vnode.");var y=a.indexOf(h);y>=0&&(a.splice(y,2),y<=c&&(c-=2),r(h,[])),g!=null&&(a.push(h,g),r(h,St(g),d))}return{mount:p,redraw:d}}});var pe=E((Ci,Ct)=>{"use strict";var $r=Qe();Ct.exports=jt()($r,typeof requestAnimationFrame<"u"?requestAnimationFrame:null,typeof console<"u"?console:null)});var Ve=E((Oi,Ot)=>{"use strict";Ot.exports=function(r){if(Object.prototype.toString.call(r)!=="[object Object]")return"";var i=[];for(var s in r)a(s,r[s]);return i.join("&");function a(o,c){if(Array.isArray(c))for(var f=0;f<c.length;f++)a(o+"["+f+"]",c[f]);else if(Object.prototype.toString.call(c)==="[object Object]")for(var f in c)a(o+"["+f+"]",c[f]);else i.push(encodeURIComponent(o)+(c!=null&&c!==""?"="+encodeURIComponent(c):""))}}});var me=E((Ri,Rt)=>{"use strict";var Lr=Ve();Rt.exports=function(r,i){if(/:([^\/\.-]+)(\.{3})?:/.test(r))throw new SyntaxError("Template parameter names must be separated by either a '/', '-', or '.'.");if(i==null)return r;var s=r.indexOf("?"),a=r.indexOf("#"),o=a<0?r.length:a,c=s<0?o:s,f=r.slice(0,c),d={};Object.assign(d,i);var p=f.replace(/:([^\/\.-]+)(\.{3})?/g,function(U,k,K){return delete d[k],i[k]==null?U:K?i[k]:encodeURIComponent(String(i[k]))}),h=p.indexOf("?"),g=p.indexOf("#"),y=g<0?p.length:g,q=h<0?y:h,w=p.slice(0,q);s>=0&&(w+=r.slice(s,o)),h>=0&&(w+=(s<0?"?":"&")+p.slice(h,y));var j=Lr(d);return j&&(w+=(s<0&&h<0?"?":"&")+j),a>=0&&(w+=r.slice(a)),g>=0&&(w+=(a<0?"":"&")+p.slice(g)),w}});var vt=E((Ai,Et)=>{"use strict";var Ur=me(),At=he();Et.exports=function(r,i){function s(c){return new Promise(c)}function a(c,f){return new Promise(function(d,p){c=Ur(c,f.params);var h=f.method!=null?f.method.toUpperCase():"GET",g=f.body,y=(f.serialize==null||f.serialize===JSON.serialize)&&!(g instanceof r.FormData||g instanceof r.URLSearchParams),q=f.responseType||(typeof f.extract=="function"?"":"json"),w=new r.XMLHttpRequest,j=!1,U=!1,k=w,K,_=w.abort;w.abort=function(){j=!0,_.call(this)},w.open(h,c,f.async!==!1,typeof f.user=="string"?f.user:void 0,typeof f.password=="string"?f.password:void 0),y&&g!=null&&!o(f,"content-type")&&w.setRequestHeader("Content-Type","application/json; charset=utf-8"),typeof f.deserialize!="function"&&!o(f,"accept")&&w.setRequestHeader("Accept","application/json, text/*"),f.withCredentials&&(w.withCredentials=f.withCredentials),f.timeout&&(w.timeout=f.timeout),w.responseType=q;for(var F in f.headers)At.call(f.headers,F)&&w.setRequestHeader(F,f.headers[F]);w.onreadystatechange=function(b){if(!j&&b.target.readyState===4)try{var A=b.target.status>=200&&b.target.status<300||b.target.status===304||/^file:\/\//i.test(c),I=b.target.response,P;if(q==="json"){if(!b.target.responseType&&typeof f.extract!="function")try{I=JSON.parse(b.target.responseText)}catch{I=null}}else(!q||q==="text")&&I==null&&(I=b.target.responseText);if(typeof f.extract=="function"?(I=f.extract(b.target,f),A=!0):typeof f.deserialize=="function"&&(I=f.deserialize(I)),A){if(typeof f.type=="function")if(Array.isArray(I))for(var v=0;v<I.length;v++)I[v]=new f.type(I[v]);else I=new f.type(I);d(I)}else{var T=function(){try{P=b.target.responseText}catch{P=I}var D=new Error(P);D.code=b.target.status,D.response=I,p(D)};w.status===0?setTimeout(function(){U||T()}):T()}}catch(D){p(D)}},w.ontimeout=function(b){U=!0;var A=new Error("Request timed out");A.code=b.target.status,p(A)},typeof f.config=="function"&&(w=f.config(w,f,c)||w,w!==k&&(K=w.abort,w.abort=function(){j=!0,K.call(this)})),g==null?w.send():typeof f.serialize=="function"?w.send(f.serialize(g)):g instanceof r.FormData||g instanceof r.URLSearchParams?w.send(g):w.send(JSON.stringify(g))})}s.prototype=Promise.prototype,s.__proto__=Promise;function o(c,f){for(var d in c.headers)if(At.call(c.headers,d)&&d.toLowerCase()===f)return!0;return!1}return{request:function(c,f){typeof c!="string"?(f=c,c=c.url):f==null&&(f={});var d=a(c,f);if(f.background===!0)return d;var p=0;function h(){--p===0&&typeof i=="function"&&i()}return g(d);function g(y){var q=y.then;return y.constructor=s,y.then=function(){p++;var w=q.apply(y,arguments);return w.then(h,function(j){if(h(),p===0)throw j}),g(w)},y}}}}});var Ft=E((Ei,Mt)=>{"use strict";var Qr=pe();Mt.exports=vt()(typeof window<"u"?window:null,Qr.redraw)});var He=E((vi,Nt)=>{"use strict";function zt(r){try{return decodeURIComponent(r)}catch{return r}}Nt.exports=function(r){if(r===""||r==null)return{};r.charAt(0)==="?"&&(r=r.slice(1));for(var i=r.split("&"),s={},a={},o=0;o<i.length;o++){var c=i[o].split("="),f=zt(c[0]),d=c.length===2?zt(c[1]):"";d==="true"?d=!0:d==="false"&&(d=!1);var p=f.split(/\]\[?|\[/),h=a;f.indexOf("[")>-1&&p.pop();for(var g=0;g<p.length;g++){var y=p[g],q=p[g+1],w=q==""||!isNaN(parseInt(q,10));if(y===""){var f=p.slice(0,g).join();s[f]==null&&(s[f]=Array.isArray(h)?h.length:0),y=s[f]++}else if(y==="__proto__")break;if(g===p.length-1)h[y]=d;else{var j=Object.getOwnPropertyDescriptor(h,y);j!=null&&(j=j.value),j==null&&(h[y]=j=w?[]:{}),h=j}}}return a}});var de=E((Mi,Pt)=>{"use strict";var Vr=He();Pt.exports=function(r){var i=r.indexOf("?"),s=r.indexOf("#"),a=s<0?r.length:s,o=i<0?a:i,c=r.slice(0,o).replace(/\/{2,}/g,"/");return c?c[0]!=="/"&&(c="/"+c):c="/",{path:c,params:i<0?{}:Vr(r.slice(i+1,a))}}});var $t=E((Fi,Dt)=>{"use strict";var Hr=de();Dt.exports=function(r){var i=Hr(r),s=Object.keys(i.params),a=[],o=new RegExp("^"+i.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(c,f,d){return f==null?"\\"+c:(a.push({k:f,r:d==="..."}),d==="..."?"(.*)":d==="."?"([^/]+)\\.":"([^/]+)"+(d||""))})+"\\/?$");return function(c){for(var f=0;f<s.length;f++)if(i.params[s[f]]!==c.params[s[f]])return!1;if(!a.length)return o.test(c.path);var d=o.exec(c.path);if(d==null)return!1;for(var f=0;f<a.length;f++)c.params[a[f].k]=a[f].r?d[f+1]:decodeURIComponent(d[f+1]);return!0}}});var _e=E((zi,Qt)=>{"use strict";var Lt=he(),Ut=new RegExp("^(?:key|oninit|oncreate|onbeforeupdate|onupdate|onbeforeremove|onremove)$");Qt.exports=function(r,i){var s={};if(i!=null)for(var a in r)Lt.call(r,a)&&!Ut.test(a)&&i.indexOf(a)<0&&(s[a]=r[a]);else for(var a in r)Lt.call(r,a)&&!Ut.test(a)&&(s[a]=r[a]);return s}});var Bt=E((Ni,_t)=>{"use strict";var _r=W(),Br=Ne(),Vt=me(),Ht=de(),Kr=$t(),kr=_e();function Jr(r){try{return decodeURIComponent(r)}catch{return r}}_t.exports=function(r,i){var s=r==null?null:typeof r.setImmediate=="function"?r.setImmediate:r.setTimeout,a=Promise.resolve(),o=!1,c=!1,f=!1,d,p,h,g,y,q,w,j,U={onremove:function(){c=f=!1,r.removeEventListener("popstate",_,!1)},view:function(){var b=_r(y,q.key,q);return g?g.render(b):[b]}},k=F.SKIP={};function K(){o=!1;var b=r.location.hash;F.prefix[0]!=="#"&&(b=r.location.search+b,F.prefix[0]!=="?"&&(b=r.location.pathname+b,b[0]!=="/"&&(b="/"+b)));var A=b.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,Jr).slice(F.prefix.length),I=Ht(A);Object.assign(I.params,r.history.state);function P(T){console.error(T),F.set(h,null,{replace:!0})}v(0);function v(T){for(;T<p.length;T++)if(p[T].check(I)){var D=p[T].component,Z=p[T].route,ae=D,J=j=function(X){if(J===j){if(X===k)return v(T+1);y=X!=null&&(typeof X.view=="function"||typeof X=="function")?X:"div",q=I.params,w=A,j=null,g=D.render?D:null,f?i.redraw():(f=!0,i.mount(d,U))}};D.view||typeof D=="function"?(D={},J(ae)):D.onmatch?a.then(function(){return D.onmatch(I.params,A,Z)}).then(J,A===h?null:P):J();return}if(A===h)throw new Error("Could not resolve default route "+h+".");F.set(h,null,{replace:!0})}}function _(){o||(o=!0,s(K))}function F(b,A,I){if(!b)throw new TypeError("DOM element being rendered to does not exist.");if(p=Object.keys(I).map(function(v){if(v[0]!=="/")throw new SyntaxError("Routes must start with a '/'.");if(/:([^\/\.-]+)(\.{3})?:/.test(v))throw new SyntaxError("Route parameter names must be separated with either '/', '.', or '-'.");return{route:v,component:I[v],check:Kr(v)}}),h=A,A!=null){var P=Ht(A);if(!p.some(function(v){return v.check(P)}))throw new ReferenceError("Default route doesn't match any known routes.")}d=b,r.addEventListener("popstate",_,!1),c=!0,K()}return F.set=function(b,A,I){if(j!=null&&(I=I||{},I.replace=!0),j=null,b=Vt(b,A),c){_();var P=I?I.state:null,v=I?I.title:null;I&&I.replace?r.history.replaceState(P,v,F.prefix+b):r.history.pushState(P,v,F.prefix+b)}else r.location.href=F.prefix+b},F.get=function(){return w},F.prefix="#!",F.Link={view:function(b){var A=Br(b.attrs.selector||"a",kr(b.attrs,["options","params","selector","onclick"]),b.children),I,P,v;return(A.attrs.disabled=!!A.attrs.disabled)?(A.attrs.href=null,A.attrs["aria-disabled"]="true"):(I=b.attrs.options,P=b.attrs.onclick,v=Vt(A.attrs.href,b.attrs.params),A.attrs.href=F.prefix+v,A.attrs.onclick=function(T){var D;typeof P=="function"?D=P.call(T.currentTarget,T):P==null||typeof P!="object"||typeof P.handleEvent=="function"&&P.handleEvent(T),D!==!1&&!T.defaultPrevented&&(T.button===0||T.which===0||T.which===1)&&(!T.currentTarget.target||T.currentTarget.target==="_self")&&!T.ctrlKey&&!T.metaKey&&!T.shiftKey&&!T.altKey&&(T.preventDefault(),T.redraw=!1,F.set(v,null,I))}),A}},F.param=function(b){return q&&b!=null?q[b]:q},F}});var kt=E((Pi,Kt)=>{"use strict";var Wr=pe();Kt.exports=Bt()(typeof window<"u"?window:null,Wr)});var Y=E((Di,Wt)=>{"use strict";var ge=gt(),Gr=Ft(),Jt=pe(),Xr=$e(),L=function(){return ge.apply(this,arguments)};L.m=ge;L.trust=ge.trust;L.fragment=ge.fragment;L.Fragment="[";L.mount=Jt.mount;L.route=kt();L.render=Qe();L.redraw=Jt.redraw;L.request=Gr.request;L.parseQueryString=He();L.buildQueryString=Ve();L.parsePathname=de();L.buildPathname=me();L.vnode=W();L.censor=_e();L.domFor=Xr.domFor;Wt.exports=L});var se=ee(Y());var ye=ee(Y());var Gt=ee(Y()),Xt={view(){return(0,Gt.default)("p.logo","Tribbleation")}};var ke=ee(Y());var Be=ee(Y());var Yt=`

return new TribbleDB($content).search({
  relation: 'name'
});

`;var re=class{static getCode(){return localStorage.getItem("tribbleations.code")}static setCode(i){localStorage.setItem("tribbleations.code",i)}static getTribbles(){return localStorage.getItem("tribbleations.tribbles")}static setTribbles(i){localStorage.setItem("tribbleations.tribbles",i)}};var er=class{#e;#t;#r;constructor(){this.#e=0,this.#t=new Map,this.#r=new Map}map(){return this.#t}reverseMap(){return this.#r}add(r){return this.#t.has(r)?this.#t.get(r):(this.#t.set(r,this.#e),this.#r.set(this.#e,r),this.#e++,this.#e-1)}setIndex(r,i){this.#t.set(r,i),this.#r.set(i,r)}getIndex(r){return this.#t.get(r)}getValue(r){return this.#r.get(r)}has(r){return this.#t.has(r)}},tr=class{static intersection(r,i){if(i.length===0)return new Set;i.sort((a,o)=>a.size-o.size);let s=new Set(i[0]);for(let a=1;a<i.length;a++){let o=i[a];for(let c of s)r.setCheck(),o.has(c)||s.delete(c);if(s.size===0)break}return s}},rr=class{stringIndex;constructor(){this.stringIndex=new er}parseTriple(r){let i=r.match(/^(\d+) (\d+) (\d+)$/);if(!i)throw new SyntaxError(`Invalid format for triple line: ${r}`);let s=this.stringIndex.getValue(parseInt(i[1],10)),a=this.stringIndex.getValue(parseInt(i[2],10)),o=this.stringIndex.getValue(parseInt(i[3],10));if(s===void 0||a===void 0||o===void 0)throw new SyntaxError(`Invalid triple reference: ${r}`);return[s,a,o]}parseDeclaration(r){let i=r.match(/^(\d+) "(.*)"$/);if(!i)throw new SyntaxError(`Invalid format for declaration line: ${r}`);let s=i[1],a=i[2];this.stringIndex.setIndex(a,parseInt(s,10))}parse(r){if(/^(\d+)\s(\d+)\s(\d+)$/.test(r))return this.parseTriple(r);this.parseDeclaration(r)}};function Yr(r,i="r\xF3"){if(!r.startsWith(`urn:${i}:`))throw new Error(`Invalid URN for namespace ${i}: ${r}`);let s=r.split(":")[2],[a,o]=r.split("?"),c=a.split(":")[3],f=o?Object.fromEntries(new URLSearchParams(o)):{};return{type:s,id:c,qs:f}}function Zt(r,i="r\xF3"){try{return Yr(r,i)}catch{return{type:"unknown",id:r,qs:{}}}}var Zr=class{mapReadCount;constructor(){this.mapReadCount=0}mapRead(){this.mapReadCount++}},ei=class{setCheckCount;constructor(){this.setCheckCount=0}setCheck(){this.setCheckCount++}},ti=class{indexedTriples;stringIndex;sourceType;sourceId;sourceQs;relations;targetType;targetId;targetQs;metrics;stringUrn;constructor(r){this.indexedTriples=[],this.stringIndex=new er,this.sourceType=new Map,this.sourceId=new Map,this.sourceQs=new Map,this.relations=new Map,this.targetType=new Map,this.targetId=new Map,this.targetQs=new Map,this.stringUrn=new Map,this.add(r),this.metrics=new Zr}add(r){let i=this.indexedTriples.length;for(let s=0;s<r.length;s++){let a=i+s,o=r[s],c=this.stringUrn.has(o[0])?this.stringUrn.get(o[0]):this.stringUrn.set(o[0],Zt(o[0])).get(o[0]),f=o[1],d=this.stringUrn.has(o[2])?this.stringUrn.get(o[2]):this.stringUrn.set(o[2],Zt(o[2])).get(o[2]),p=this.stringIndex.add(c.type),h=this.stringIndex.add(c.id),g=this.stringIndex.add(f),y=this.stringIndex.add(d.type),q=this.stringIndex.add(d.id);this.indexedTriples.push([this.stringIndex.add(o[0]),g,this.stringIndex.add(o[2])]),this.sourceType.has(p)||this.sourceType.set(p,new Set),this.sourceType.get(p).add(a),this.sourceId.has(h)||this.sourceId.set(h,new Set),this.sourceId.get(h).add(a);for(let[w,j]of Object.entries(c.qs)){let U=this.stringIndex.add(`${w}=${j}`);this.sourceQs.has(U)||this.sourceQs.set(U,new Set),this.sourceQs.get(U).add(a)}this.relations.has(g)||this.relations.set(g,new Set),this.relations.get(g).add(a),this.targetType.has(y)||this.targetType.set(y,new Set),this.targetType.get(y).add(a),this.targetId.has(q)||this.targetId.set(q,new Set),this.targetId.get(q).add(a);for(let[w,j]of Object.entries(d.qs)){let U=this.stringIndex.add(`${w}=${j}`);this.targetQs.has(U)||this.targetQs.set(U,new Set),this.targetQs.get(U).add(a)}}}get length(){return this.indexedTriples.length}triples(){return this.indexedTriples.map(([r,i,s])=>[this.stringIndex.getValue(r),this.stringIndex.getValue(i),this.stringIndex.getValue(s)])}getTriple(r){if(r<0||r>=this.indexedTriples.length)return;let[i,s,a]=this.indexedTriples[r];return[this.stringIndex.getValue(i),this.stringIndex.getValue(s),this.stringIndex.getValue(a)]}getTripleIndices(r){if(!(r<0||r>=this.indexedTriples.length))return this.indexedTriples[r]}getSourceTypeSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.sourceType.get(i)}getSourceIdSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.sourceId.get(i)}getSourceQsSet(r,i){let s=this.stringIndex.getIndex(`${r}=${i}`);if(s!==void 0)return this.metrics.mapRead(),this.sourceQs.get(s)}getRelationSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.relations.get(i)}getTargetTypeSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.targetType.get(i)}getTargetIdSet(r){let i=this.stringIndex.getIndex(r);if(i!==void 0)return this.metrics.mapRead(),this.targetId.get(i)}getTargetQsSet(r,i){let s=this.stringIndex.getIndex(`${r}=${i}`);if(s!==void 0)return this.metrics.mapRead(),this.targetQs.get(s)}},G=class{static source(r){return r[0]}static relation(r){return r[1]}static target(r){return r[2]}};function ri(r,i,s){let a=i.names.concat(s.names);if(i.rows.length===0||s.rows.length===0)return{names:a,rows:[]};let o=new Map,c=new Map;for(let p=0;p<i.rows.length;p++){let h=i.rows[p][2];o.has(h)||o.set(h,[]),o.get(h).push(p)}for(let p=0;p<s.rows.length;p++){let h=s.rows[p][0];c.has(h)||c.set(h,[]),c.get(h).push(p)}let f=tr.intersection(r,[new Set(o.keys()),new Set(c.keys())]),d=[];for(let p of f){let h=c.get(p),g=o.get(p);for(let y of h)for(let q of g){let w=i.rows[y].concat(s.rows[q]);d.push(w)}}return{names:a,rows:d}}var ir=class ie{index;triplesCount;cursorIndices;metrics;constructor(i){this.index=new ti(i),this.triplesCount=this.index.length,this.cursorIndices=new Set,this.metrics=new ei;for(let s=0;s<this.triplesCount;s++)this.cursorIndices.add(s)}clone(){let i=new ie([]);return i.index=this.index,i.triplesCount=this.triplesCount,i.cursorIndices=this.cursorIndices,i.metrics=this.metrics,i}static of(i){return new ie(i)}static from(i){let s=[];for(let a of i){let{id:o,...c}=a;if(typeof o!="string")throw new Error("Each TripleObject must have a string id.");for(let[f,d]of Object.entries(c))if(Array.isArray(d))for(let p of d)s.push([o,f,p]);else s.push([o,f,d])}return new ie(s)}add(i){let s=this.index.length;this.index.add(i),this.triplesCount=this.index.length;for(let a=s;a<this.triplesCount;a++)this.cursorIndices.add(a)}map(i){return new ie(this.index.triples().map(i))}flatMap(i){let s=this.index.triples().flatMap(i);return new ie(s)}firstTriple(){return this.index.length>0?this.index.getTriple(0):void 0}firstSource(){let i=this.firstTriple();return i?G.source(i):void 0}firstRelation(){let i=this.firstTriple();return i?G.relation(i):void 0}firstTarget(){let i=this.firstTriple();return i?G.target(i):void 0}firstObject(i=!1){return this.objects(i)[0]}triples(){return this.index.triples()}sources(){return new Set(this.index.triples().map(G.source))}relations(){return new Set(this.index.triples().map(G.relation))}targets(){return new Set(this.index.triples().map(G.target))}objects(i=!1){let s=[];for(let[a,o]of Object.entries(this.object(i)))o.id=a,s.push(o);return s}object(i=!1){let s={};for(let[a,o,c]of this.index.triples())s[a]||(s[a]={id:a}),s[a][o]?Array.isArray(s[a][o])?s[a][o].push(c):s[a][o]=[s[a][o],c]:s[a][o]=i?[c]:c;return s}#e(i){let s=[this.cursorIndices],{source:a,relation:o,target:c}=i;if(typeof a>"u"&&typeof c>"u"&&typeof o>"u")throw new Error("At least one search parameter must be defined");let f=["source","relation","target"];for(let h of Object.keys(i))if(Object.prototype.hasOwnProperty.call(i,h)&&!f.includes(h))throw new Error(`Unexpected search parameter: ${h}`);if(a){if(a.type){let h=this.index.getSourceTypeSet(a.type);if(h)s.push(h);else return new Set}if(a.id){let h=this.index.getSourceIdSet(a.id);if(h)s.push(h);else return new Set}if(a.qs)for(let[h,g]of Object.entries(a.qs)){let y=this.index.getSourceQsSet(h,g);if(y)s.push(y);else return new Set}}if(c){if(c.type){let h=this.index.getTargetTypeSet(c.type);if(h)s.push(h);else return new Set}if(c.id){let h=this.index.getTargetIdSet(c.id);if(h)s.push(h);else return new Set}if(c.qs)for(let[h,g]of Object.entries(c.qs)){let y=this.index.getTargetQsSet(h,g);if(y)s.push(y);else return new Set}}if(o){let h=typeof o=="string"?{relation:[o]}:o;if(h.relation){let g=new Set;for(let y of h.relation){let q=this.index.getRelationSet(y);if(q)for(let w of q)g.add(w)}if(g.size>0)s.push(g);else return new Set}}let d=tr.intersection(this.metrics,s),p=new Set;for(let h of d){let g=this.index.getTriple(h);if(!a?.predicate&&!c?.predicate&&!(typeof o=="object"&&o.predicate)){p.add(h);continue}let y=!0;a?.predicate&&(y=y&&a.predicate(G.source(g))),c?.predicate&&(y=y&&c.predicate(G.target(g))),typeof o=="object"&&o.predicate&&(y=y&&o.predicate(G.relation(g))),y&&p.add(h)}return p}search(i){let s=[];for(let a of this.#e(i)){let o=this.index.getTriple(a);o&&s.push(o)}return new ie(s)}search2(i){let s=Object.entries(i),a=[];for(let d=0;d<s.length-2;d+=2){let p=s.slice(d,d+3),h={source:p[0][1],relation:p[1][1],target:p[2][1]},g=p.map(w=>w[0]),y=this.#e(h),q=Array.from(y).flatMap(w=>{let j=this.index.getTripleIndices(w);return typeof j>"u"?[]:[j]});a.push({names:g,rows:q})}let o=a.reduce(ri.bind(this,this.metrics)),c=o.names,f=[];for(let d of o.rows){let p={};for(let h=0;h<c.length;h++){let g=c[h];p[g]=this.index.stringIndex.getValue(d[h])}f.push(p)}return f}getMetrics(){return{index:this.index.metrics,db:this.metrics}}};function ii(){let r=nr(re.getTribbles()??""),i=re.getCode()??Yt,s=[];try{s=Ke(r??[],O.outputFormat)}catch{s=[]}return{code:i,codeFailure:"",outputFormat:"rows",results:r??[],objects:s}}var O=ii();function ni(r){try{return new Function(r),null}catch(i){return i}}function si(r){let i=r.target;O.code=i.value,re.setCode(O.code);let s=ni(O.code);s?(console.error("failed to parse code"),O.codeFailure=`Failed to parse code: ${s.message}`):O.codeFailure="";let a=Ke(O.results,O.outputFormat);O.objects=a??[],Be.default.redraw()}function ai(r){return new Promise((i,s)=>{let a=new FileReader;a.onload=o=>{let c=o.target?.result;i(c)},a.readAsText(r)})}function ui(r){try{return new Function("$content","TribbleDB",O.code)(r,ir)}catch(i){console.error("failed to execute code",i),O.codeFailure=`Failed to execute code: ${i.message}`;return}}function Ke(r,i){let s=ui(r);if(!s||!s.objects){O.codeFailure="Code did not return a TribbleDB object",O.objects=[];return}return s.objects()}function nr(r){if(!r)return;let i=new rr,s=[];for(let a of r.split(`
`)){if(!a)continue;let o=i.parse(a);o&&s.push(o)}return s}async function oi(r){let i=r.target;if(!i.files||i.files.length===0)return;let[s]=i.files,a=await ai(s);re.setTribbles(a);let o=nr(a);typeof o<"u"&&(O.results=o);let c=Ke(O.results,O.outputFormat);O.objects=c??[],Be.default.redraw()}var we={updateCode(r){return si(r)},async onFileChange(r){return await oi(r)}};var sr={view(){return(0,ke.default)("div.workspace",[(0,ke.default)("input.workspace[type=file]",{onchange:we.onFileChange})])}};var ar={view(){return(0,ye.default)("header",[(0,ye.default)(Xt),(0,ye.default)(sr)])}};var xe=ee(Y());var ur={view(){return(0,xe.default)("div.editor-container",[(0,xe.default)("p#error",O.codeFailure),(0,xe.default)("textarea.editor",{value:O.code,spellcheck:!1,onkeyup:we.updateCode})])}};var B=ee(Y());function fi(){let r=O.objects.length>0?Object.keys(O.objects[0]):[],i=O.objects.map(s=>r.map(a=>s[a]??""));if(O.objects.length>0)return(0,B.default)("div.output",[(0,B.default)("h3",`Output ${O.objects.length} rows`),(0,B.default)("table",[(0,B.default)("tr",r.map(s=>(0,B.default)("th",s))),...i.map(s=>(0,B.default)("tr",s.map(a=>(0,B.default)("td",a))))])])}function ci(){return(0,B.default)("div.output",[(0,B.default)("h3",`Output ${O.results.length} rows`),(0,B.default)("table",[...O.results.map(r=>(0,B.default)("tr",r.map(i=>(0,B.default)("td",i))))])])}var or={view(){return O.outputFormat==="rows"?ci():O.outputFormat==="objects"?fi():(0,B.default)("p","unsupported output format")}};var li={view(){return(0,se.default)("div.grid",[(0,se.default)(ar),(0,se.default)(ur),(0,se.default)(or)])}};se.default.mount(document.body,li);
//# sourceMappingURL=app.js.map
